from reportlab.lib.pagesizes import landscape, A4
from reportlab.lib import colors
from reportlab.pdfgen import canvas
from reportlab.lib.units import cm
from reportlab.pdfbase import pdfmetrics
from reportlab.pdfbase.ttfonts import TTFont

# Configurações visuais
arquivo_pdf = "Invest53App_Checklist.pdf"
titulo = "Invest53App - Checklist Premium (Versão Leve)"
rodape = "Desenvolvido por Investidor aos 50 • Edição Premium (Versão Leve)"

# Criar PDF
c = canvas.Canvas(arquivo_pdf, pagesize=landscape(A4))
largura, altura = landscape(A4)

# Fundo grafite metálico
c.setFillColorRGB(0.12, 0.12, 0.12)
c.rect(0, 0, largura, altura, stroke=0, fill=1)

# Título
c.setFont("Helvetica-Bold", 26)
c.setFillColorRGB(0.83, 0.68, 0.21)  # dourado metálico
c.drawCentredString(largura / 2, altura - 3 * cm, titulo)

# Linha divisória
c.setStrokeColorRGB(0.7, 0.7, 0.7)
c.setLineWidth(1)
c.line(2*cm, altura - 3.5*cm, largura - 2*cm, altura - 3.5*cm)

# Corpo de texto
c.setFont("Helvetica", 14)
c.setFillColor(colors.whitesmoke)
texto = [
    "✅ Estrutura do App Flask pronta",
    "✅ Geração automática de PDF estilizado",
    "✅ Tema Premium Investidor (grafite, dourado e prateado)",
    "✅ Total compatibilidade com Render.com",
    "✅ Rodapé discreto com assinatura da marca",
]
y = altura - 6 * cm
for linha in texto:
    c.drawString(3 * cm, y, linha)
    y -= 1 * cm

# Rodapé
c.setFont("Helvetica-Oblique", 10)
c.setFillColorRGB(0.75, 0.75, 0.75)
c.drawCentredString(largura / 2, 1.2 * cm, rodape)

# Finaliza PDF
c.showPage()
c.save()

print(f"✅ PDF '{arquivo_pdf}' gerado com sucesso.")
